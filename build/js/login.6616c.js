webpackJsonp([2],{237:function(e,t){"use strict";function a(e,t,a,n,r){var l={method:e,mode:"cors",headers:{"Content-Type":"application/json"},body:"GET"==e?null:JSON.stringify(a)};"get"==e.toLowerCase()&&(t+=s._getSearchFromObject(a)),fetch(t,l).then(s.checkStates).then(s.parseJSON).then(function(e){n(e)}).catch(function(e){return console.log(e),401==e.state?(alert("登录过期,重新登录"),void(location.hash="login")):void(e.response&&e.response.json().then(function(e){console.log(e),e.message&&alert(e.message)}))})}function n(e,t,a,n){var r=new XMLHttpRequest;r.open("POST",e),r.onload=function(e){var t=JSON.parse(r.responseText);if(200==r.status)a(t);else{var n=t;n.message&&alert(n.message)}},r.send(t)}Object.defineProperty(t,"__esModule",{value:!0});var r="userToken",l="http://114.215.80.72:4545/",s={checkStates:function(e){if(e.ok)return e;var t=new Error(e.statusText);throw t.state=e.status,t.response=e,t},parseJSON:function(e){return e.json()},_getSearchFromObject:function(e,t){if(null==e)return"";var a="?";for(var n in e)a+=n+"="+encodeURIComponent(e[n])+"&";return a.slice(0,-1)}},o={storeToken:function(e){localStorage.setItem(r,e)},fetchToken:function(){return localStorage.getItem(r)},register:function(e,t,n){a("POST",l+"user/register",e,t,n)},login:function(e,t,n){a("POST",l+"user/login",e,t,n)},getUserInfo:function(e,t,n){a("GET",l+"user/getUserInfo",e,t,n)},uploadAvatar:function(e,t,a){n(l+"user/uploadAvatar",e,t,a)},fetchArticle:function(e,t,n){a("GET",l+"user/fetchArticle",e,t,n)}},i={pulish:function(e,t,n){a("POST",l+"article/pulish",e,t,n)},fetchList:function(e,t,n){a("GET",l+"article/fetchList",e,t,n)},fetchArticle:function(e,t,n){a("GET",l+"article/fetchArticle/"+e,null,t,n)},giveStar:function(e,t,n){a("POST",l+"article/giveStar",e,t,n)},comment:function(e,t,n){a("POST",l+"article/comment",e,t,n)}};t.UserModel=o,t.ArticleModel=i},244:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(1),c=n(i),u=a(245),f=n(u),m=a(237),d={header:{lineHeight:"2.2rem"},floatLeft:{float:"left"},floatRight:{float:"right"}},p=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={loginFlag:!0,username:"",email:"",password:"",rpassword:""},a}return s(t,e),o(t,[{key:"componentDidMount",value:function(){}},{key:"changeLoginFlag",value:function(e){e.stopPropagation(),this.setState({loginFlag:!0})}},{key:"changeRegisterFlag",value:function(e){e.stopPropagation(),this.setState({loginFlag:!1})}},{key:"userRegister",value:function(){var e=/^\s+$/,t=this.state;switch(""){case t.username:return void $.alert("用户名不能为空");case t.email:return void $.alert("邮箱不能为空");case t.password:return void $.alert("密码不能为空");case t.rpassword:return void $.alert("两次密码不一致")}if(!/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(this.state.email))return void $.alert("邮箱格式不正确");if(t.password!=t.rpassword)return void $.alert("两次密码不一致");if(t.password.length<6)return void $.alert("密码不得少于6位数");if(e.test(t.username))return void $.alert("用户名不能为空");var a=(0,f.default)(this.state.password),n={username:this.state.username,email:this.state.email,password:a};m.UserModel.register(n,function(e){"1"==e.id?($.toast("注册成功"),m.UserModel.storeToken(e.content),location.hash="/indexList"):"2"==e.id?$.toast(e.content):"3"==e.id&&$.toast(e.content)},function(e){console.log(e)})}},{key:"handleChangeVal",value:function(e,t){var a=e.target.value;switch(t){case"username":this.setState({username:a});break;case"email":this.setState({email:a});break;case"password":this.setState({password:a});break;case"rpassword":this.setState({rpassword:a})}}},{key:"formReset",value:function(){this.setState({username:"",email:"",password:"",rpassword:""})}},{key:"userLogin",value:function(){var e=this,t=this.refs.username.value,a=(0,f.default)(this.refs.password.value),n={username:t,password:a};m.UserModel.login(n,function(t){console.log(t),m.UserModel.storeToken(t.content),$.toast("登录成功"),e.context.router.push("/me")},function(e){$.toast("登录失败")})}},{key:"render",value:function(){var e=this,t=this.state.loginFlag?c.default.createElement("div",{className:"content"},c.default.createElement("div",{className:"list-block"},c.default.createElement("ul",null,c.default.createElement("li",null,c.default.createElement("div",{className:"item-content"},c.default.createElement("div",{className:"item-media"},c.default.createElement("i",{className:"icon icon-form-name"})),c.default.createElement("div",{className:"item-inner"},c.default.createElement("div",{className:"item-title label"},"用户名"),c.default.createElement("div",{className:"item-input"},c.default.createElement("input",{type:"text",ref:"username",placeholder:"Your name"}))))),c.default.createElement("li",null,c.default.createElement("div",{className:"item-content"},c.default.createElement("div",{className:"item-media"},c.default.createElement("i",{className:"icon icon-form-password"})),c.default.createElement("div",{className:"item-inner"},c.default.createElement("div",{className:"item-title label"},"密码"),c.default.createElement("div",{className:"item-input"},c.default.createElement("input",{type:"password",ref:"password",placeholder:"Password",className:""}))))))),c.default.createElement("div",{className:"content-block"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-100"},c.default.createElement("a",{onClick:function(){e.userLogin()},className:"button button-big button-fill button-success"},"登录"))))):c.default.createElement("div",{className:"content"},c.default.createElement("form",{action:"",onClick:function(e){e.stopPropagation()}},c.default.createElement("div",{className:"list-block"},c.default.createElement("ul",null,c.default.createElement("li",null,c.default.createElement("div",{className:"item-content"},c.default.createElement("div",{className:"item-media"},c.default.createElement("i",{className:"icon icon-form-name"})),c.default.createElement("div",{className:"item-inner"},c.default.createElement("div",{className:"item-title label"},"用户名"),c.default.createElement("div",{className:"item-input"},c.default.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:function(t){e.handleChangeVal(t,"username")},ref:"username",placeholder:"Your name"}))))),c.default.createElement("li",null,c.default.createElement("div",{className:"item-content"},c.default.createElement("div",{className:"item-media"},c.default.createElement("i",{className:"icon icon-form-email"})),c.default.createElement("div",{className:"item-inner"},c.default.createElement("div",{className:"item-title label"},"邮箱"),c.default.createElement("div",{className:"item-input"},c.default.createElement("input",{type:"email",name:"email",ref:"email",value:this.state.email,onChange:function(t){e.handleChangeVal(t,"email")},placeholder:"E-mail"}))))),c.default.createElement("li",null,c.default.createElement("div",{className:"item-content"},c.default.createElement("div",{className:"item-media"},c.default.createElement("i",{className:"icon icon-form-password"})),c.default.createElement("div",{className:"item-inner"},c.default.createElement("div",{className:"item-title label"},"密码"),c.default.createElement("div",{className:"item-input"},c.default.createElement("input",{type:"password",ref:"password",name:"password",placeholder:"Password",value:this.state.password,onChange:function(t){e.handleChangeVal(t,"password")},className:""}))))),c.default.createElement("li",null,c.default.createElement("div",{className:"item-content"},c.default.createElement("div",{className:"item-media"},c.default.createElement("i",{className:"icon icon-form-password"})),c.default.createElement("div",{className:"item-inner"},c.default.createElement("div",{className:"item-title label"},"确认密码"),c.default.createElement("div",{className:"item-input"},c.default.createElement("input",{type:"password",ref:"rpassword",name:"rpassword",placeholder:"Password",value:this.state.rpassword,onChange:function(t){e.handleChangeVal(t,"rpassword")},className:""}))))))),c.default.createElement("div",{className:"content-block"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-50"},c.default.createElement("a",{onClick:function(){e.formReset()},className:"button button-big button-fill button-danger"},"重置")),c.default.createElement("div",{className:"col-50"},c.default.createElement("a",{onClick:function(){e.userRegister()},className:"button button-big button-fill button-success",type:"submit"},"注册"))))));return c.default.createElement("main",null,c.default.createElement("header",{className:"bar bar-nav row",style:d.header},c.default.createElement("a",{className:"col-50",id:"login",ref:"login",onClick:function(t){return e.changeLoginFlag(t)}},c.default.createElement("span",{className:"tab-label"},"登录")),c.default.createElement("a",{className:"col-50",id:"register",ref:"register",onClick:function(t){return e.changeRegisterFlag(t)}},c.default.createElement("span",{className:"tab-label",style:d.floatRight},"注册"))),t)}}]),t}(c.default.Component);p.contextTypes={router:c.default.PropTypes.object},e.exports=p},245:function(e,t,a){"use strict";!function(){var t=a(246),n=a(247).utf8,r=a(248),l=a(247).bin,s=function e(a,s){a.constructor==String?a=s&&"binary"===s.encoding?l.stringToBytes(a):n.stringToBytes(a):r(a)?a=Array.prototype.slice.call(a,0):Array.isArray(a)||(a=a.toString());for(var o=t.bytesToWords(a),i=8*a.length,c=1732584193,u=-271733879,f=-1732584194,m=271733878,d=0;d<o.length;d++)o[d]=16711935&(o[d]<<8|o[d]>>>24)|4278255360&(o[d]<<24|o[d]>>>8);o[i>>>5]|=128<<i%32,o[(i+64>>>9<<4)+14]=i;for(var p=e._ff,h=e._gg,g=e._hh,v=e._ii,d=0;d<o.length;d+=16){var E=c,b=u,y=f,N=m;c=p(c,u,f,m,o[d+0],7,-680876936),m=p(m,c,u,f,o[d+1],12,-389564586),f=p(f,m,c,u,o[d+2],17,606105819),u=p(u,f,m,c,o[d+3],22,-1044525330),c=p(c,u,f,m,o[d+4],7,-176418897),m=p(m,c,u,f,o[d+5],12,1200080426),f=p(f,m,c,u,o[d+6],17,-1473231341),u=p(u,f,m,c,o[d+7],22,-45705983),c=p(c,u,f,m,o[d+8],7,1770035416),m=p(m,c,u,f,o[d+9],12,-1958414417),f=p(f,m,c,u,o[d+10],17,-42063),u=p(u,f,m,c,o[d+11],22,-1990404162),c=p(c,u,f,m,o[d+12],7,1804603682),m=p(m,c,u,f,o[d+13],12,-40341101),f=p(f,m,c,u,o[d+14],17,-1502002290),u=p(u,f,m,c,o[d+15],22,1236535329),c=h(c,u,f,m,o[d+1],5,-165796510),m=h(m,c,u,f,o[d+6],9,-1069501632),f=h(f,m,c,u,o[d+11],14,643717713),u=h(u,f,m,c,o[d+0],20,-373897302),c=h(c,u,f,m,o[d+5],5,-701558691),m=h(m,c,u,f,o[d+10],9,38016083),f=h(f,m,c,u,o[d+15],14,-660478335),u=h(u,f,m,c,o[d+4],20,-405537848),c=h(c,u,f,m,o[d+9],5,568446438),m=h(m,c,u,f,o[d+14],9,-1019803690),f=h(f,m,c,u,o[d+3],14,-187363961),u=h(u,f,m,c,o[d+8],20,1163531501),c=h(c,u,f,m,o[d+13],5,-1444681467),m=h(m,c,u,f,o[d+2],9,-51403784),f=h(f,m,c,u,o[d+7],14,1735328473),u=h(u,f,m,c,o[d+12],20,-1926607734),c=g(c,u,f,m,o[d+5],4,-378558),m=g(m,c,u,f,o[d+8],11,-2022574463),f=g(f,m,c,u,o[d+11],16,1839030562),u=g(u,f,m,c,o[d+14],23,-35309556),c=g(c,u,f,m,o[d+1],4,-1530992060),m=g(m,c,u,f,o[d+4],11,1272893353),f=g(f,m,c,u,o[d+7],16,-155497632),u=g(u,f,m,c,o[d+10],23,-1094730640),c=g(c,u,f,m,o[d+13],4,681279174),m=g(m,c,u,f,o[d+0],11,-358537222),f=g(f,m,c,u,o[d+3],16,-722521979),u=g(u,f,m,c,o[d+6],23,76029189),c=g(c,u,f,m,o[d+9],4,-640364487),m=g(m,c,u,f,o[d+12],11,-421815835),f=g(f,m,c,u,o[d+15],16,530742520),u=g(u,f,m,c,o[d+2],23,-995338651),c=v(c,u,f,m,o[d+0],6,-198630844),m=v(m,c,u,f,o[d+7],10,1126891415),f=v(f,m,c,u,o[d+14],15,-1416354905),u=v(u,f,m,c,o[d+5],21,-57434055),c=v(c,u,f,m,o[d+12],6,1700485571),m=v(m,c,u,f,o[d+3],10,-1894986606),f=v(f,m,c,u,o[d+10],15,-1051523),u=v(u,f,m,c,o[d+1],21,-2054922799),c=v(c,u,f,m,o[d+8],6,1873313359),m=v(m,c,u,f,o[d+15],10,-30611744),f=v(f,m,c,u,o[d+6],15,-1560198380),u=v(u,f,m,c,o[d+13],21,1309151649),c=v(c,u,f,m,o[d+4],6,-145523070),m=v(m,c,u,f,o[d+11],10,-1120210379),f=v(f,m,c,u,o[d+2],15,718787259),u=v(u,f,m,c,o[d+9],21,-343485551),c=c+E>>>0,u=u+b>>>0,f=f+y>>>0,m=m+N>>>0}return t.endian([c,u,f,m])};s._ff=function(e,t,a,n,r,l,s){var o=e+(t&a|~t&n)+(r>>>0)+s;return(o<<l|o>>>32-l)+t},s._gg=function(e,t,a,n,r,l,s){var o=e+(t&n|a&~n)+(r>>>0)+s;return(o<<l|o>>>32-l)+t},s._hh=function(e,t,a,n,r,l,s){var o=e+(t^a^n)+(r>>>0)+s;return(o<<l|o>>>32-l)+t},s._ii=function(e,t,a,n,r,l,s){var o=e+(a^(t|~n))+(r>>>0)+s;return(o<<l|o>>>32-l)+t},s._blocksize=16,s._digestsize=16,e.exports=function(e,a){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var n=t.wordsToBytes(s(e,a));return a&&a.asBytes?n:a&&a.asString?l.bytesToString(n):t.bytesToHex(n)}}()},246:function(e,t){"use strict";!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&a.rotl(e,8)|4278255360&a.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=a.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],a=0,n=0;a<e.length;a++,n+=8)t[n>>>5]|=e[a]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],a=0;a<32*e.length;a+=8)t.push(e[a>>>5]>>>24-a%32&255);return t},bytesToHex:function(e){for(var t=[],a=0;a<e.length;a++)t.push((e[a]>>>4).toString(16)),t.push((15&e[a]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],a=0;a<e.length;a+=2)t.push(parseInt(e.substr(a,2),16));return t},bytesToBase64:function(e){for(var a=[],n=0;n<e.length;n+=3)for(var r=e[n]<<16|e[n+1]<<8|e[n+2],l=0;l<4;l++)8*n+6*l<=8*e.length?a.push(t.charAt(r>>>6*(3-l)&63)):a.push("=");return a.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var a=[],n=0,r=0;n<e.length;r=++n%4)0!=r&&a.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*r+8)-1)<<2*r|t.indexOf(e.charAt(n))>>>6-2*r);return a}};e.exports=a}()},247:function(e,t){"use strict";var a={utf8:{stringToBytes:function(e){return a.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(a.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],a=0;a<e.length;a++)t.push(255&e.charCodeAt(a));return t},bytesToString:function(e){for(var t=[],a=0;a<e.length;a++)t.push(String.fromCharCode(e[a]));return t.join("")}}};e.exports=a},248:function(e,t){"use strict";function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function n(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&a(e.slice(0,0))}/*!
	 * Determine if an object is a Buffer
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
e.exports=function(e){return null!=e&&(a(e)||n(e)||!!e._isBuffer)}}});