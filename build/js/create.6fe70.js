webpackJsonp([4],{237:function(e,t){"use strict";function n(e,t,n,a,l){var o={method:e,mode:"cors",headers:{"Content-Type":"application/json"},body:"GET"==e?null:JSON.stringify(n)};"get"==e.toLowerCase()&&(t+=r._getSearchFromObject(n)),fetch(t,o).then(r.checkStates).then(r.parseJSON).then(function(e){a(e)}).catch(function(e){return console.log(e),401==e.state?(alert("登录过期,重新登录"),void(location.hash="login")):void(e.response&&e.response.json().then(function(e){console.log(e),e.message&&alert(e.message)}))})}function a(e,t,n,a){var l=new XMLHttpRequest;l.open("POST",e),l.onload=function(e){var t=JSON.parse(l.responseText);if(200==l.status)n(t);else{var a=t;a.message&&alert(a.message)}},l.send(t)}Object.defineProperty(t,"__esModule",{value:!0});var l="userToken",o="http://114.215.80.72:4545/",r={checkStates:function(e){if(e.ok)return e;var t=new Error(e.statusText);throw t.state=e.status,t.response=e,t},parseJSON:function(e){return e.json()},_getSearchFromObject:function(e,t){if(null==e)return"";var n="?";for(var a in e)n+=a+"="+encodeURIComponent(e[a])+"&";return n.slice(0,-1)}},c={storeToken:function(e){localStorage.setItem(l,e)},fetchToken:function(){return localStorage.getItem(l)},register:function(e,t,a){n("POST",o+"user/register",e,t,a)},login:function(e,t,a){n("POST",o+"user/login",e,t,a)},getUserInfo:function(e,t,a){n("GET",o+"user/getUserInfo",e,t,a)},uploadAvatar:function(e,t,n){a(o+"user/uploadAvatar",e,t,n)},fetchArticle:function(e,t,a){n("GET",o+"user/fetchArticle",e,t,a)}},i={pulish:function(e,t,a){n("POST",o+"article/pulish",e,t,a)},fetchList:function(e,t,a){n("GET",o+"article/fetchList",e,t,a)},fetchArticle:function(e,t,a){n("GET",o+"article/fetchArticle/"+e,null,t,a)},giveStar:function(e,t,a){n("POST",o+"article/giveStar",e,t,a)},comment:function(e,t,a){n("POST",o+"article/comment",e,t,a)}};t.UserModel=c,t.ArticleModel=i},250:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(1),s=a(i),u=n(237),f=function(e){function t(e){l(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a=u.UserModel.fetchToken();return a||(location.hash="/login"),n.state={token:a,title:"",content:"",pageTitle:"发表文章",articleId:null},n}return r(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this.props.params.id;e&&(this.fetchData(e),this.setState({pageTitle:"修改文章",articleId:e}))}},{key:"fetchData",value:function(e){var t=this;u.ArticleModel.fetchArticle(e,function(e){t.setState({title:e.content.title,content:e.content.content,article:e.content.article_id})},function(e){console.log(e)})}},{key:"handlePublish",value:function(e){var t=this.refs.title.value,n=this.refs.content.value;if(""==t)return void $.alert("标题不能为空");if(""==n)return void $.alert("内容不能为空");var a={title:t,content:n,token:this.state.token,article:this.state.articleId?this.state.articleId:""};console.log(a),u.ArticleModel.pulish(a,function(e){$.toast(e.content),location.hash="/indexList"},function(e){$.alert(e)})}},{key:"handleChangeVal",value:function(e,t){var n=e.target.value;"title"==t?this.setState({title:n}):this.setState({content:n})}},{key:"render",value:function(){var e=this;return s.default.createElement("div",null,s.default.createElement("header",{className:"bar bar-nav"},s.default.createElement("h1",{className:"title"},this.state.pageTitle)),s.default.createElement("div",{className:"content"},s.default.createElement("div",{className:"list-block"},s.default.createElement("ul",null,s.default.createElement("li",null,s.default.createElement("div",{className:"item-content"},s.default.createElement("div",{className:"item-inner",style:{borderBottom:"2px solid #eee"}},s.default.createElement("div",{className:"item-input"},s.default.createElement("input",{type:"text",ref:"title",placeholder:"请输入标题",value:this.state.title,onChange:function(t){e.handleChangeVal(t,"title")}}))))),s.default.createElement("li",{className:"align-top"},s.default.createElement("div",{className:"item-content"},s.default.createElement("div",{className:"item-inner"},s.default.createElement("div",{className:"item-input"},s.default.createElement("textarea",{placeholder:"请输入内容",ref:"content",style:{height:"13rem"},onChange:function(t){e.handleChangeVal(t,"content")},value:this.state.content}))))))),s.default.createElement("div",{className:"content-block"},s.default.createElement("div",{className:"row"},s.default.createElement("div",{className:"col-50"},s.default.createElement("a",{className:"button button-big button-fill button-danger",onClick:function(t){e.handleCancel(t)}},"取消")),s.default.createElement("div",{className:"col-50"},s.default.createElement("a",{className:"button button-big button-fill button-success",onClick:function(t){e.handlePublish(t)}},"发表"))))))}}]),t}(s.default.Component);e.exports=f}});