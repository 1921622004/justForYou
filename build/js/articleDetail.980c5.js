webpackJsonp([3],{237:function(e,t){"use strict";function n(e,t,n,r,o){var a={method:e,mode:"cors",headers:{"Content-Type":"application/json"},body:"GET"==e?null:JSON.stringify(n)};"get"==e.toLowerCase()&&(t+=i._getSearchFromObject(n)),fetch(t,a).then(i.checkStates).then(i.parseJSON).then(function(e){r(e)}).catch(function(e){return console.log(e),401==e.state?(alert("登录过期,重新登录"),void(location.hash="login")):void(e.response&&e.response.json().then(function(e){console.log(e),e.message&&alert(e.message)}))})}function r(e,t,n,r){var o=new XMLHttpRequest;o.open("POST",e),o.onload=function(e){var t=JSON.parse(o.responseText);if(200==o.status)n(t);else{var r=t;r.message&&alert(r.message)}},o.send(t)}Object.defineProperty(t,"__esModule",{value:!0});var o="userToken",a="http://114.215.80.72:4545/",i={checkStates:function(e){if(e.ok)return e;var t=new Error(e.statusText);throw t.state=e.status,t.response=e,t},parseJSON:function(e){return e.json()},_getSearchFromObject:function(e,t){if(null==e)return"";var n="?";for(var r in e)n+=r+"="+encodeURIComponent(e[r])+"&";return n.slice(0,-1)}},l={storeToken:function(e){localStorage.setItem(o,e)},fetchToken:function(){return localStorage.getItem(o)},register:function(e,t,r){n("POST",a+"user/register",e,t,r)},login:function(e,t,r){n("POST",a+"user/login",e,t,r)},getUserInfo:function(e,t,r){n("GET",a+"user/getUserInfo",e,t,r)},uploadAvatar:function(e,t,n){r(a+"user/uploadAvatar",e,t,n)},fetchArticle:function(e,t,r){n("GET",a+"user/fetchArticle",e,t,r)}},s={pulish:function(e,t,r){n("POST",a+"article/pulish",e,t,r)},fetchList:function(e,t,r){n("GET",a+"article/fetchList",e,t,r)},fetchArticle:function(e,t,r){n("GET",a+"article/fetchArticle/"+e,null,t,r)},giveStar:function(e,t,r){n("POST",a+"article/giveStar",e,t,r)},comment:function(e,t,r){n("POST",a+"article/comment",e,t,r)}};t.UserModel=l,t.ArticleModel=s},238:function(e,t,n){var r=n(239);"string"==typeof r&&(r=[[e.id,r,""]]);n(241)(r,{});r.locals&&(e.exports=r.locals)},239:function(e,t,n){t=e.exports=n(240)(),t.push([e.id,"a{color:inherit}.floatLeft{float:left}.floatRight{float:right}.indexList{padding-right:.75rem}.big{font-size:30px}.article{text-indent:2em;font-size:15px}#app{height:100%}.marR{margin-right:.4rem}.font12{font-size:13px}.content{top:-40px}.detailContent{position:absolute;top:0;right:0;bottom:50px;left:0;padding:.5rem;background:#fff;overflow:auto}.clearPt{font-size:18px}.clearPL,.clearPt{margin-top:0;margin-bottom:0}.clearPL{font-size:16px}li,ul{list-style:none;margin:0;padding:0}hr{height:1px;border:none;border-top:1px solid #eee}.comment{position:fixed;bottom:0;height:60px;padding-top:5px;background:#fff;width:100%;z-index:999;padding:3px .5rem;box-shadow:0 -1px 3px 0 #888}.commentInput{padding:0 .5rem;height:100%}.commentAvatar{height:2rem;width:2rem}.commentList{border-top:1px solid #e0e0e0;padding:.2rem 0}.loading{height:44px;width:100%}.pullToRefreshBox{position:relative;left:0;top:0;width:100%;height:40px}.pullToRefreshBox .pullToRefreshArrow{width:1rem;height:1rem;position:absolute;left:50%;top:50%;margin-left:-.15rem;margin-top:-.5rem;background:no-repeat 50%;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 26 40'%3E%3Cpath fill='%238c8c8c' d='M9 22V0h8v22h9L13.5 40 0 22z'/%3E%3C/svg%3E\");background-size:.65rem 1rem;z-index:11;-webkit-transform:rotate(0deg) translateZ(0);transform:rotate(0deg) translateZ(0);-webkit-transition-duration:.3s;transition-duration:.3s}.pullToRefreshBox.up .pullToRefreshArrow{-webkit-transform:rotate(180deg) translateZ(0);transform:rotate(180deg) translateZ(0)}.pullToRefreshBox .preloader{display:none;width:1rem;height:1rem;position:absolute;left:50%;top:50%;margin-left:-.15rem;margin-top:-.5rem;background:no-repeat 50%;background-image:url(\"http://uploadfile.huiyi8.com/2014/1023/20141023034756992.gif\");background-size:1rem 1rem;z-index:10}.scroll{width:100%;margin-top:0;padding:0;height:100%;overflow:auto;padding-bottom:50px}.outerScroller{position:absolute;top:-40px;bottom:0;width:100%;left:0;overflow:hidden}",""])},240:function(e,t){"use strict";e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(r[a]=!0)}for(o=0;o<t.length;o++){var i=t[o];"number"==typeof i[0]&&r[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),e.push(i))}},e}},241:function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=d[r.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(c(r.parts[a],t))}else{for(var i=[],a=0;a<r.parts.length;a++)i.push(c(r.parts[a],t));d[r.id]={id:r.id,refs:1,parts:i}}}}function o(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],a=o[0],i=o[1],l=o[2],s=o[3],c={css:i,media:l,sourceMap:s};n[a]?n[a].parts.push(c):t.push(n[a]={id:a,parts:[c]})}return t}function a(e,t){var n=g(),r=x[x.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),x.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function i(e){e.parentNode.removeChild(e);var t=x.indexOf(e);t>=0&&x.splice(t,1)}function l(e){var t=document.createElement("style");return t.type="text/css",a(e,t),t}function s(e){var t=document.createElement("link");return t.rel="stylesheet",a(e,t),t}function c(e,t){var n,r,o;if(t.singleton){var a=b++;n=v||(v=l(t)),r=u.bind(null,n,a,!1),o=u.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(t),r=p.bind(null,n),o=function(){i(n),n.href&&URL.revokeObjectURL(n.href)}):(n=l(t),r=f.bind(null,n),o=function(){i(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function u(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=y(t,o);else{var a=document.createTextNode(o),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}function f(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function p(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}var d={},m=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},h=m(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),g=m(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,b=0,x=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=h()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=o(e);return r(n,t),function(e){for(var a=[],i=0;i<n.length;i++){var l=n[i],s=d[l.id];s.refs--,a.push(s)}if(e){var c=o(e);r(c,t)}for(var i=0;i<a.length;i++){var s=a[i];if(0===s.refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete d[s.id]}}}};var y=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},243:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){var t=(new Date).getTime(),n=t-e,r="",o=6e4,a=60*o,i=24*a,l=30*i,s=12*l,c=n/s,u=n/l,f=n/(7*i),p=n/i,d=n/a,m=n/o;return r=c>=1?parseInt(c)+"年前":u>=1?parseInt(u)+"个月前":f>=1?parseInt(f)+"周前":p>=1?parseInt(p)+"天前":d>=1?parseInt(d)+"个小时前":m>=1?parseInt(m)+"分钟前":"刚刚"};t.dateDiff=n},249:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),c=r(s);n(238);var u=n(237),f=n(243),p=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return $.showIndicator(),n.state={commentList:[],article:"",author:"",comment:[]},n}return i(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.params.id;u.ArticleModel.fetchArticle(t,function(t){e.setState({article:t.content,author:t.content.author,comment:t.content.comments}),$.hideIndicator()},function(e){console.log(e)})}},{key:"commentList",value:function e(){var e=this.state.comment.map(function(e,t){return c.default.createElement("li",{className:"row",key:t},c.default.createElement("div",{className:"col-15",style:{padding:"0.3rem 0"}},c.default.createElement("img",{className:"commentAvatar",src:e.avatar,alt:""})),c.default.createElement("div",{className:"col-85 commentList"},c.default.createElement("div",{style:{fontWeight:"bold",fontSize:"15px"}},e.username),c.default.createElement("p",{style:{margin:"0.2rem 0",fontSize:"14px"}},e.comment),c.default.createElement("div",{style:{fontSize:"12px"}},c.default.createElement("span",{className:"icon icon-clock"}," ")," ",(0,f.dateDiff)(e.createAt))))});return c.default.createElement("ul",null,e)}},{key:"checkLogin",value:function(){var e=u.UserModel.fetchToken();e||$.alert("您还没有登录")}},{key:"handleComment",value:function(){var e=this,t=this.refs.commentText.value,n=this.props.params.id,r=u.UserModel.fetchToken();if(r){var o={userId:r,articleId:n,comment:t};u.ArticleModel.comment(o,function(t){console.log(t),$.toast(t.content),e.refs.commentText.value="",e.componentDidMount()},function(e){console.log(e)})}else $.alert("您还没有登录")}},{key:"render",value:function(){var e=this;return c.default.createElement("div",null,c.default.createElement("main",{className:"detailContent"},c.default.createElement("h2",{className:"clearPt"},this.state.article.title),c.default.createElement("div",null,c.default.createElement("span",{className:"font12 marR"},"作者:",this.state.author.username),c.default.createElement("span",{className:"font12"},"发表于:",(0,f.dateDiff)(this.state.article.createAt))),c.default.createElement("hr",null),c.default.createElement("div",{className:"article"},this.state.article.content),c.default.createElement("hr",null),c.default.createElement("div",null,c.default.createElement("h3",{className:"clearPL"},"评论:"),this.commentList())),c.default.createElement("div",{className:"comment row no-gutter",style:{margin:"none",zIndex:"2002"}},c.default.createElement("input",{type:"text",style:{border:"none"},ref:"commentText",className:"col-75 commentInput",placeholder:"说点什么吧",onChange:this.checkLogin}),c.default.createElement("a",{onClick:function(){e.handleComment()},className:"button col-25 button-fill button-big"},"评论")))}}]),t}(c.default.Component);e.exports=p}});